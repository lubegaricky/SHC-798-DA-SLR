---
title: "SHC 798 Assignment 2, 2025"
author: "Richard Lubega"
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document:
    latex_engine: xelatex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

# SHC 798 Assignment 2, 2025

## Analysis of Variance (ANOVA)

### Question 4: \# Compressive strength results

```{r, Part-1-a}
pacman::p_load(tidymodels)

# Getting started with the dataset in timber.csv :
timber <- read.csv(file.choose(), header = TRUE, na.strings = c("NA"))
# timber
head(timber)
str(timber)
## Convert species column to a factor
timber$species <- factor(timber$species)
## Check levels
levels(timber$species)

## Visualize data
stripchart(stiffness ~ species, data = timber, pch = 1, vertical = TRUE)

# Part a): # Box Plots
boxplot(stiffness ~ species,
        data = timber,
        main = "Bending Stiffness by Timber Species",
        xlab = "Timber Species",
        ylab = "Bending Stiffness (kNÂ·mÂ²)",
        col = c("lightblue", "lightgreen", "lightpink"),
        border = "black")
#Adding means as points
means <- tapply(timber$stiffness, timber$species, mean)
points(1:3, means, pch = 19, col = "red")
# Annotate outliers on the plot
# text(x = bp$group, y = bp$out, labels = bp$out, pos = 3, cex = 0.7, col = "darkblue")
```

#### **Commenting on Variability and Outliers**

*Variability*: Standard Deviation (SD): Gum has the highest variability (SD = 641.0 kNÂ·mÂ²), followed by cedar (SD = 572.8 kNÂ·mÂ²), and pine has the lowest (SD = 552.6 kNÂ·mÂ²). This suggests that gum's stiffness values are more spread out compared to pine and cedar.

*Interquartile Range (IQR)*: Pine has the highest IQR (696.8 kNÂ·mÂ²), indicating a slightly wider spread of the middle 50% of stiffness values compared to gum (673.8 kNÂ·mÂ²) and cedar (659.1 kNÂ·mÂ²). However, the differences in IQR are small, suggesting comparable spread in the central data across species.

*Range (Max - Min)*: Gum shows the largest range (11124.5 - 8314.9 = 2809.6 kNÂ·mÂ²), followed by cedar (10074.9 - 8220.3 = 1854.6 kNÂ·mÂ²), and pine (8982.9 - 6999.2 = 1983.7 kNÂ·mÂ²). This reinforces that gum has the most extreme values.

*Central Tendency*: Gum has the highest median stiffness (9425.3 kNÂ·mÂ²), followed by cedar (9387.7 kNÂ·mÂ²), and pine (8139.2 kNÂ·mÂ²). This indicates that gum and cedar generally have higher bending stiffness than pine.

In short;

**Variability**: Gum exhibits the highest variability in bending stiffness, as seen in its larger SD and range, suggesting less consistency in its mechanical properties compared to pine and cedar. Cedar and pine have similar variability, but pineâ€™s stiffness values are generally lower.

**Outliers**: Pine has one low outlier, indicating a single timber sample with unusually low stiffness, possibly due to defects or testing conditions. Gum has both a high and a low outlier, suggesting it can exhibit extreme stiffness values (both stronger and weaker), which may reflect natural variability or quality differences in the samples. Cedarâ€™s lack of outliers suggests greater consistency in its stiffness properties.

**Practical Implications**: If consistency is desired, cedar may be preferable due to its lack of outliers and moderate variability. Gumâ€™s higher median stiffness is appealing for strength, but its outliers and variability suggest a need for quality control. Pineâ€™s lower stiffness and single outlier may indicate itâ€™s less suitable for applications requiring high or consistent stiffness.

```{r, Part-1-b}
# Part b):# Fit a one-way ANOVA test
timber$species <- relevel(timber$species, ref = "gum")
options(contrasts = c("contr.sum", "contr.poly"))
# options(contrasts = c("contr.treatment", "contr.poly")) # used as default anyway

stiff <- aov(stiffness ~ species, data = timber)
summary(stiff) ## ANOVA table including F-test

## Extract coefficients
coef(stiff)       ## be careful with interpretation
dummy.coef(stiff) ## full coefficients, easier to interpret
```

### **Model Interpreation**

*Null hypothesis* (Hâ‚€): ðœ‡~pine~ = ðœ‡~gum~ = ðœ‡~cedar~ (All species have the same mean bending stiffness)

*Alternative hypothesis* (H~A~): At least one species has a different mean stiffness.

\*\*F-statistic\*: 32.17; Large F-value indicates that between-species variability is much greater than within-species variability.

p-value: 4.45 Ã— 10â»Â¹â°;Extremely small (\< 0.001), so we reject Hâ‚€ at any conventional significance level (e.g., 0.05 or 0.01).

**Conclusion**: There is **strong statistical evidence** that the mean bending stiffness differs significantly between timber species.

```{r, Part-1-c}
# Part c) # A pairwise two-sample t-tests (with multiple comparison correction)
# Perform pairwise t-tests with Bonferroni correction
tapply(timber$stiffness, timber$species, sd) # check for group SD
tapply(timber$stiffness, timber$species, var) # check for group var
pairwise_results <- pairwise.t.test(timber$stiffness, timber$species, 
                                    p.adjust.method = "bonferroni", 
                                    pool.sd = FALSE, # Welch's t-test (unequal variances)
                                    paired = FALSE,  # Independent samples
                                    conf.level = 0.95)

# Print the results
print("Pairwise t-test results with Bonferroni correction:")
print(pairwise_results)

```

### **Test Interpretation**

\*\*Test method\*: Welch-adjusted pairwise t-tests because the groups have unequal variances. This adjusts the degrees of freedom for each pair according to Welchâ€™s formula.

N*Null hypothesis* (Hâ‚€): ðœ‡~pine~ = ðœ‡~gum~ = ðœ‡~cedar~ (All species have the same mean bending stiffness)

Reject Hâ‚€ if p \< 0.05.

**Interpretation of each pair**

:   **pine vs gum**: p = 8.1 Ã— 10â»â¸ \< 0.05 â†’ significant; Mean stiffness differs between pine and gum, hence gum is stiffer than pine (looking at raw data: gum â‰ˆ 9500 vs pine â‰ˆ 8100).

~ pine vs cedar: p = 6.0 Ã— 10â»â¸ \< 0.05 â†’ significant, Mean stiffness differs between pine and cedar hence cedar is stiffer than pine (cedar â‰ˆ 9400).

~ **gum vs cedar*: p = 1 â†’ not significant, No evidence that gum and cedar differ in mean stiffness.
Their stiffness values are roughly similar (gum â‰ˆ 9500, cedar â‰ˆ 9400).

Therefore, In practical terms, pine is the softest, while gum and cedar have similar higher stiffness.

```{r, Part-1-d}
# Part d) ## Residual Diagnostics
plot(stiff, which = 2)
plot(stiff, which = 1)

```

From the residual plots (TA), error variance  is constant and error can be expected to be zero.
Errors are i.i.d (from Q-Q plot). No autocorrelation.
